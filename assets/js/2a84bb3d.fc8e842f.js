"use strict";(self.webpackChunkdocusaurus_documentation=self.webpackChunkdocusaurus_documentation||[]).push([[6642],{6533:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>c});var i=s(5893),r=s(1151);const l={title:"ALB vs NLB for Istio - Avoiding the Double L7 Trap",description:"Understanding L4 vs L7 Load Balancing in a Service Mesh",image:"https://www.wedaa.tech/docs/img/blog/ALBvsNLBIstio/ALBvsNLB_network_analogy.png",tags:["istio","service-mesh","kubernetes","eks","aws","nlb","alb","load-balancer","l4-vs-l7","cloud-architecture","platform-engineering","microservices"],date:new Date("2025-12-26T00:00:00.000Z")},t=void 0,a={permalink:"/docs/blog/2025/12/24/Avoiding-Double-L7-Trap",source:"@site/blog/2025-12-24-Avoiding-Double-L7-Trap.md",title:"ALB vs NLB for Istio - Avoiding the Double L7 Trap",description:"Understanding L4 vs L7 Load Balancing in a Service Mesh",date:"2025-12-26T00:00:00.000Z",formattedDate:"December 26, 2025",tags:[{label:"istio",permalink:"/docs/blog/tags/istio"},{label:"service-mesh",permalink:"/docs/blog/tags/service-mesh"},{label:"kubernetes",permalink:"/docs/blog/tags/kubernetes"},{label:"eks",permalink:"/docs/blog/tags/eks"},{label:"aws",permalink:"/docs/blog/tags/aws"},{label:"nlb",permalink:"/docs/blog/tags/nlb"},{label:"alb",permalink:"/docs/blog/tags/alb"},{label:"load-balancer",permalink:"/docs/blog/tags/load-balancer"},{label:"l4-vs-l7",permalink:"/docs/blog/tags/l-4-vs-l-7"},{label:"cloud-architecture",permalink:"/docs/blog/tags/cloud-architecture"},{label:"platform-engineering",permalink:"/docs/blog/tags/platform-engineering"},{label:"microservices",permalink:"/docs/blog/tags/microservices"}],readingTime:2.76,hasTruncateMarker:!1,authors:[],frontMatter:{title:"ALB vs NLB for Istio - Avoiding the Double L7 Trap",description:"Understanding L4 vs L7 Load Balancing in a Service Mesh",image:"https://www.wedaa.tech/docs/img/blog/ALBvsNLBIstio/ALBvsNLB_network_analogy.png",tags:["istio","service-mesh","kubernetes","eks","aws","nlb","alb","load-balancer","l4-vs-l7","cloud-architecture","platform-engineering","microservices"],date:"2025-12-26T00:00:00.000Z"},unlisted:!1,nextItem:{title:"How WeDAA Beat Load Balancer Limits Using Kong API Gateway",permalink:"/docs/blog/2025/04/08/kong-apigateway"}},o={authorsImageUrls:[]},c=[{value:"Introduction",id:"introduction",level:2},{value:"L4 vs L7 (Only What Matters)",id:"l4-vs-l7-only-what-matters",level:2},{value:"Layer 4 (Transport Layer)",id:"layer-4-transport-layer",level:3},{value:"Layer 7 (Application Layer)",id:"layer-7-application-layer",level:3},{value:"What Istio Expects",id:"what-istio-expects",level:2},{value:"ALB + Istio: The Double L7 Trap",id:"alb--istio-the-double-l7-trap",level:2},{value:"NLB + Istio: Clean Separation",id:"nlb--istio-clean-separation",level:2},{value:"Simple Analogy",id:"simple-analogy",level:2},{value:"When ALB Can Still Make Sense",id:"when-alb-can-still-make-sense",level:2},{value:"Final Recommendation",id:"final-recommendation",level:2},{value:"Key Takeaway",id:"key-takeaway",level:2}];function d(e){const n={blockquote:"blockquote",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["When running ",(0,i.jsx)(n.strong,{children:"Istio"})," on Kubernetes (especially on ",(0,i.jsx)(n.strong,{children:"AWS EKS"}),"), a common question is:"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Should I put an ",(0,i.jsx)(n.strong,{children:"Application Load Balancer (ALB)"})," or a ",(0,i.jsx)(n.strong,{children:"Network Load Balancer (NLB)"})," in front of Istio?"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Istio on Kubernetes with load balancers",src:s(5030).Z+"",width:"1536",height:"1024"})}),"\n",(0,i.jsxs)(n.p,{children:["At first glance, both seem to work. Traffic reaches the cluster and the application responds.",(0,i.jsx)(n.br,{}),"\n","But once you understand ",(0,i.jsx)(n.strong,{children:"Layer 4 vs Layer 7"})," and how a ",(0,i.jsx)(n.strong,{children:"service mesh"})," is designed, the right choice becomes clear."]}),"\n",(0,i.jsxs)(n.p,{children:["This post explains ",(0,i.jsx)(n.strong,{children:"why NLB fits Istio better than ALB"})," and how using ALB can lead to a ",(0,i.jsx)(n.strong,{children:"double L7 anti-pattern"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"l4-vs-l7-only-what-matters",children:"L4 vs L7 (Only What Matters)"}),"\n",(0,i.jsx)(n.h3,{id:"layer-4-transport-layer",children:"Layer 4 (Transport Layer)"}),"\n",(0,i.jsxs)(n.p,{children:["Layer 4 is about ",(0,i.jsx)(n.strong,{children:"connections"}),", not requests."]}),"\n",(0,i.jsx)(n.p,{children:"It understands:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"TCP / UDP"}),"\n",(0,i.jsx)(n.li,{children:"IP addresses and ports"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["It does ",(0,i.jsx)(n.em,{children:"not"})," understand:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"HTTP paths"}),"\n",(0,i.jsx)(n.li,{children:"Headers"}),"\n",(0,i.jsx)(n.li,{children:"Hostnames"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Connect to 10.0.1.5:443\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u27a1\ufe0f ",(0,i.jsx)(n.strong,{children:"AWS NLB works at Layer 4"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"layer-7-application-layer",children:"Layer 7 (Application Layer)"}),"\n",(0,i.jsxs)(n.p,{children:["Layer 7 understands ",(0,i.jsx)(n.strong,{children:"what the request means"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"It understands:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"HTTP / HTTPS / gRPC"}),"\n",(0,i.jsxs)(n.li,{children:["Paths like ",(0,i.jsx)(n.code,{children:"/api/orders"})]}),"\n",(0,i.jsxs)(n.li,{children:["Hosts like ",(0,i.jsx)(n.code,{children:"app.example.com"})]}),"\n",(0,i.jsx)(n.li,{children:"Headers, retries, timeouts"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"GET /api/orders\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u27a1\ufe0f ",(0,i.jsx)(n.strong,{children:"Istio (Envoy) works at Layer 7"}),(0,i.jsx)(n.br,{}),"\n","\u27a1\ufe0f ",(0,i.jsx)(n.strong,{children:"AWS ALB also works at Layer 7"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"what-istio-expects",children:"What Istio Expects"}),"\n",(0,i.jsxs)(n.p,{children:["Istio is a ",(0,i.jsx)(n.strong,{children:"service mesh"}),", not just a proxy."]}),"\n",(0,i.jsx)(n.p,{children:"It controls:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Routing"}),"\n",(0,i.jsx)(n.li,{children:"Traffic splitting"}),"\n",(0,i.jsx)(n.li,{children:"Retries and timeouts"}),"\n",(0,i.jsx)(n.li,{children:"mTLS and security policies"}),"\n",(0,i.jsx)(n.li,{children:"Observability"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["All of this requires ",(0,i.jsx)(n.strong,{children:"Layer 7 context"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"So the key idea is:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Istio expects to be the single Layer 7 decision-maker."})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"alb--istio-the-double-l7-trap",children:"ALB + Istio: The Double L7 Trap"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Client\n   \u2193\nALB (L7)\n   \u2193\nIstio Envoy (L7)\n   \u2193\nApplication\n"})}),"\n",(0,i.jsx)(n.p,{children:"Here\u2019s the problem:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ALB inspects and routes HTTP"}),"\n",(0,i.jsx)(n.li,{children:"Istio inspects and routes HTTP again"}),"\n",(0,i.jsx)(n.li,{children:"Routing logic is split across two systems"}),"\n",(0,i.jsx)(n.li,{children:"Health checks often conflict"}),"\n",(0,i.jsx)(n.li,{children:"TLS is usually terminated before Istio"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This creates unnecessary complexity and confusion."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"nlb--istio-clean-separation",children:"NLB + Istio: Clean Separation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Client\n   \u2193\nNLB (L4)\n   \u2193\nIstio Envoy (L7)\n   \u2193\nApplication\n"})}),"\n",(0,i.jsx)(n.p,{children:"With this setup:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"NLB only forwards TCP traffic"}),"\n",(0,i.jsx)(n.li,{children:"Istio handles all HTTP logic"}),"\n",(0,i.jsx)(n.li,{children:"No overlapping responsibilities"}),"\n",(0,i.jsx)(n.li,{children:"Cleaner security and observability"}),"\n",(0,i.jsx)(n.li,{children:"Fewer edge-case failures"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This is the ",(0,i.jsx)(n.strong,{children:"service-mesh-native design"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"ALB vs NLB with Istio \u2014 Avoiding the Double L7 Trap",src:s(6198).Z+"",width:"1536",height:"1024"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["Left: ALB + Istio introduces two Layer-7 decision points (the Double L7 Trap).",(0,i.jsx)(n.br,{}),"\n","Right: NLB forwards at Layer-4 while Istio remains the single Layer-7 authority."]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"simple-analogy",children:"Simple Analogy"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"ALB vs NLB network analogy",src:s(4029).Z+"",width:"1536",height:"1024"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"ALB + Istio"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Two traffic cops trying to control the same intersection."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"NLB + Istio"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"One tunnel (NLB) and one traffic cop (Istio)."}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"when-alb-can-still-make-sense",children:"When ALB Can Still Make Sense"}),"\n",(0,i.jsx)(n.p,{children:"ALB is fine if:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You are not using Istio for ingress routing"}),"\n",(0,i.jsx)(n.li,{children:"You want AWS-managed L7 routing at the edge"}),"\n",(0,i.jsx)(n.li,{children:"Istio is used only for internal service-to-service traffic"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"But if Istio manages ingress traffic, ALB becomes redundant."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"final-recommendation",children:"Final Recommendation"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"End-End Request Flow",src:s(5478).Z+"",width:"1248",height:"832"})}),"\n",(0,i.jsx)(n.p,{children:"For Istio on EKS:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u2705 Use ",(0,i.jsx)(n.strong,{children:"NLB (Layer 4)"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 Let ",(0,i.jsx)(n.strong,{children:"Istio control Layer 7"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u274c Avoid ",(0,i.jsx)(n.strong,{children:"ALB + Istio ingress"})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"key-takeaway",children:"Key Takeaway"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"A service mesh needs one Layer 7 brain."}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Everything before it should stay simple and dumb."})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["That\u2019s why ",(0,i.jsx)(n.strong,{children:"NLB works best with Istio"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},6198:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/ALBvsNLB-b3050c15114b1f0631e10543581945df.png"},4029:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/ALBvsNLB_network_analogy-b3b13e725946cd39e794b45c1d3533eb.png"},5030:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/Istio_on_k8s_with_elb-fe38a2be6af331b8c7eeb9b9fc1e0849.png"},5478:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/request-flow-a2b168bb14614faefa8a6eb607a99acf.png"},1151:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>t});var i=s(7294);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);